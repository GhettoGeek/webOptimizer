#!/usr/bin/env node
'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _clientnode=require('clientnode'),_clientnode2=_interopRequireDefault(_clientnode),_fs=require('fs'),fileSystem=_interopRequireWildcard(_fs),_path=require('path'),_path2=_interopRequireDefault(_path),_helper=require('./helper.compiled'),_helper2=_interopRequireDefault(_helper),_package=require('./package');function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}try{require('source-map-support/register')}catch(a){}let metaConfiguration=_package.configuration;for(metaConfiguration.default.path.context=__dirname,metaConfiguration.default.contextType='main';metaConfiguration.default.path.context=_path2.default.resolve(metaConfiguration.default.path.context,'../../'),'node_modules'===_path2.default.basename(_path2.default.dirname(metaConfiguration.default.path.context)););if('node_modules'===_path2.default.basename(_path2.default.dirname(process.cwd()))||'.staging'===_path2.default.basename(_path2.default.dirname(process.cwd()))&&'node_modules'===_path2.default.basename(_path2.default.dirname(_path2.default.dirname(process.cwd()))))metaConfiguration.default.path.context=process.cwd(),metaConfiguration.default.contextType='dependency';else try{fileSystem.lstatSync(_path2.default.join(process.cwd(),'node_modules')).isSymbolicLink()&&(metaConfiguration.default.path.context=process.cwd())}catch(a){}let specificConfiguration;try{specificConfiguration=eval('require')(_path2.default.join(metaConfiguration.default.path.context,'package'))}catch(a){specificConfiguration={name:'mockup'},metaConfiguration.default.path.context=process.cwd()}const name=specificConfiguration.name;specificConfiguration=specificConfiguration.webOptimizer||{},specificConfiguration.name=name;let debug=metaConfiguration.default.debug;specificConfiguration.debug!==void 0&&(debug=specificConfiguration.debug),process.env.npm_config_production?debug=!1:process.env.npm_config_debug&&(debug=!0),metaConfiguration.default.path.context+='/';const libraryConfiguration=metaConfiguration.library;let configuration;configuration=debug?_clientnode2.default.extendObject(!0,_clientnode2.default.modifyObject(metaConfiguration.default,metaConfiguration.debug),metaConfiguration.debug):metaConfiguration.default,configuration.debug=debug,'object'==typeof configuration.library&&_clientnode2.default.extendObject(!0,_clientnode2.default.modifyObject(libraryConfiguration,configuration.library),configuration.library),('library'in specificConfiguration&&!0===specificConfiguration.library||('library'in specificConfiguration&&specificConfiguration.library===void 0||!('library'in specificConfiguration))&&configuration.library)&&(configuration=_clientnode2.default.extendObject(!0,_clientnode2.default.modifyObject(configuration,libraryConfiguration),libraryConfiguration));let count=0,filePath=null;for(;;){const a=configuration.path.context+`.dynamicConfiguration-${count}.json`;if(!_clientnode2.default.isFileSync(a))break;filePath=a,count+=1}let runtimeInformation={givenCommandLineArguments:process.argv};if(filePath&&(runtimeInformation=JSON.parse(fileSystem.readFileSync(filePath,{encoding:configuration.encoding})),fileSystem.unlink(filePath,(a)=>{if(a)throw a})),2<runtimeInformation.givenCommandLineArguments.length)for(const a of['document','test','testInBrowser'])runtimeInformation.givenCommandLineArguments[2]===a&&_clientnode2.default.extendObject(!0,_clientnode2.default.modifyObject(configuration,configuration[a]),configuration[a]);for(const a of['document','test','testInBrowser'])delete configuration[a];_clientnode2.default.extendObject(!0,_clientnode2.default.modifyObject(_clientnode2.default.modifyObject(configuration,specificConfiguration),runtimeInformation),specificConfiguration,runtimeInformation);let result=null;if(3<runtimeInformation.givenCommandLineArguments.length&&(result=_clientnode2.default.stringParseEncodedObject(runtimeInformation.givenCommandLineArguments[runtimeInformation.givenCommandLineArguments.length-1],configuration,'configuration')),_clientnode2.default.isPlainObject(result)&&_clientnode2.default.extendObject(!0,_clientnode2.default.modifyObject(configuration,result),result),configuration.dllManifestFilePaths=[],_clientnode2.default.isDirectorySync(configuration.path.target.base))for(const a of fileSystem.readdirSync(configuration.path.target.base))a.match(/^.*\.dll-manifest\.json$/)&&configuration.dllManifestFilePaths.push(_path2.default.resolve(configuration.path.target.base,a));const parameterDescription=['currentPath','fileSystem','Helper','path','require','Tools','webOptimizerPath'],parameter=[process.cwd(),fileSystem,_helper2.default,_path2.default,eval('require'),_clientnode2.default,__dirname];for(const a in configuration.path.base=_path2.default.resolve(configuration.path.context,configuration.path.base),configuration.path)if(configuration.path.hasOwnProperty(a)&&'base'!==a&&'string'==typeof configuration.path[a])configuration.path[a]=_path2.default.resolve(configuration.path.base,configuration.path[a])+'/';else if(_clientnode2.default.isPlainObject(configuration.path[a]))for(const b in configuration.path[a].base=_path2.default.resolve(configuration.path.base,configuration.path[a].base),configuration.path[a])if(configuration.path[a].hasOwnProperty(b)&&!['base','public'].includes(b)&&'string'==typeof configuration.path[a][b])configuration.path[a][b]=_path2.default.resolve(configuration.path[a].base,configuration.path[a][b])+'/';else if(_clientnode2.default.isPlainObject(configuration.path[a][b]))for(const c in configuration.path[a][b].base=_path2.default.resolve(configuration.path[a].base,configuration.path[a][b].base),configuration.path[a][b])configuration.path[a][b].hasOwnProperty(c)&&'base'!==c&&'string'==typeof configuration.path[a][b][c]&&(configuration.path[a][b][c]=_path2.default.resolve(configuration.path[a][b].base,configuration.path[a][b][c])+'/');const resolvedConfiguration=_clientnode2.default.resolveDynamicDataStructure(configuration,parameterDescription,parameter),defaultConfiguration=resolvedConfiguration.build.types.default;for(const a in delete resolvedConfiguration.build.types.default,resolvedConfiguration.build.types)resolvedConfiguration.build.types.hasOwnProperty(a)&&(resolvedConfiguration.build.types[a]=_clientnode2.default.extendObject(!0,{},defaultConfiguration,_clientnode2.default.extendObject(!0,{extension:a},resolvedConfiguration.build.types[a],{type:a})));resolvedConfiguration.module.locations=_helper2.default.determineModuleLocations(resolvedConfiguration.injection.internal,resolvedConfiguration.module.aliases,resolvedConfiguration.module.replacements.normal,resolvedConfiguration.extensions,resolvedConfiguration.path.context,resolvedConfiguration.path.source.asset.base),resolvedConfiguration.injection=_helper2.default.resolveInjection(resolvedConfiguration.injection,_helper2.default.resolveBuildConfigurationFilePaths(resolvedConfiguration.build.types,resolvedConfiguration.path.source.asset.base,_helper2.default.normalizePaths(resolvedConfiguration.path.ignore.concat(resolvedConfiguration.module.directoryNames,resolvedConfiguration.loader.directoryNames).map((a)=>_path2.default.resolve(resolvedConfiguration.path.context,a)).filter((a)=>!resolvedConfiguration.path.context.startsWith(a))),resolvedConfiguration.package.main.fileNames),resolvedConfiguration.injection.autoExclude,resolvedConfiguration.module.aliases,resolvedConfiguration.module.replacements.normal,resolvedConfiguration.extensions,resolvedConfiguration.path.context,resolvedConfiguration.path.source.asset.base,resolvedConfiguration.path.ignore);const internalInjection=resolvedConfiguration.injection.internal;for(const a in resolvedConfiguration.injection.internal={given:resolvedConfiguration.injection.internal,normalized:_helper2.default.resolveModulesInFolders(_helper2.default.normalizeInternalInjection(internalInjection),resolvedConfiguration.module.aliases,resolvedConfiguration.module.replacements.normal,resolvedConfiguration.extensions,resolvedConfiguration.path.context,resolvedConfiguration.path.source.asset.base,resolvedConfiguration.path.ignore.concat(resolvedConfiguration.module.directoryNames,resolvedConfiguration.loader.directoryNames).map((a)=>_path2.default.resolve(resolvedConfiguration.path.context,a)).filter((a)=>!resolvedConfiguration.path.context.startsWith(a)))},resolvedConfiguration.needed={javaScript:configuration.debug&&['serve','testInBrowser'].includes(resolvedConfiguration.givenCommandLineArguments[2])},resolvedConfiguration.injection.internal.normalized)if(resolvedConfiguration.injection.internal.normalized.hasOwnProperty(a))for(const b of resolvedConfiguration.injection.internal.normalized[a]){const c=_helper2.default.determineModuleFilePath(b,resolvedConfiguration.module.aliases,resolvedConfiguration.module.replacements.normal,resolvedConfiguration.extensions,resolvedConfiguration.path.context,'./',resolvedConfiguration.path.ignore,resolvedConfiguration.module.directoryNames,resolvedConfiguration.package.main.fileNames,resolvedConfiguration.package.main.propertyNames,resolvedConfiguration.package.aliasPropertyNames,resolvedConfiguration.encoding);let d;if(c)d=_helper2.default.determineAssetType(c,resolvedConfiguration.build.types,resolvedConfiguration.path);else throw new Error(`Given request "${b}" couldn't be resolved.`);d&&(resolvedConfiguration.needed[d]=!0)}resolvedConfiguration.loader.aliases.webOptimizerDefaultTemplateFileLoader='';for(const a of resolvedConfiguration.files.defaultHTML.template.use)resolvedConfiguration.loader.aliases.webOptimizerDefaultTemplateFileLoader&&(resolvedConfiguration.loader.aliases.webOptimizerDefaultTemplateFileLoader+='!'),resolvedConfiguration.loader.aliases.webOptimizerDefaultTemplateFileLoader+=a.loader,a.options&&(resolvedConfiguration.loader.aliases.webOptimizerDefaultTemplateFileLoader+='?'+_clientnode2.default.convertCircularObjectToJSON(a.options));resolvedConfiguration.module.aliases.webOptimizerDefaultTemplateFilePath$=resolvedConfiguration.files.defaultHTML.template.filePath;for(let a of resolvedConfiguration.files.html)if(_clientnode2.default.extendObject(!0,a,resolvedConfiguration.files.defaultHTML),a.template.request=a.template.filePath,a.template.filePath!==resolvedConfiguration.files.defaultHTML.template.filePath&&a.template.options){const b=new String(a.template.request+_clientnode2.default.convertCircularObjectToJSON(a.template.options));b.replace=((c)=>()=>c)(a.template.filePath),a.template.request=b}exports.default=resolvedConfiguration;

//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3hDLEMsZ0JBR1UscUIiLCJmaWxlIjoiY29uZmlndXJhdG9yLmNvbXBpbGVkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG4vLyBAZmxvd1xuLy8gLSotIGNvZGluZzogdXRmLTggLSotXG4ndXNlIHN0cmljdCdcbi8qICFcbiAgICByZWdpb24gaGVhZGVyXG4gICAgQ29weXJpZ2h0IFRvcmJlbiBTaWNrZXJ0IChpbmZvW1wifmF0flwiXXRvcmJlbi53ZWJzaXRlKSAxNi4xMi4yMDEyXG5cbiAgICBMaWNlbnNlXG4gICAgLS0tLS0tLVxuXG4gICAgVGhpcyBsaWJyYXJ5IHdyaXR0ZW4gYnkgVG9yYmVuIFNpY2tlcnQgc3RhbmQgdW5kZXIgYSBjcmVhdGl2ZSBjb21tb25zIG5hbWluZ1xuICAgIDMuMCB1bnBvcnRlZCBsaWNlbnNlLiBzZWUgaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvMy4wL2RlZWQuZGVcbiAgICBlbmRyZWdpb25cbiovXG4vLyByZWdpb24gaW1wb3J0c1xuaW1wb3J0IFRvb2xzIGZyb20gJ2NsaWVudG5vZGUnXG5pbXBvcnQgdHlwZSB7UGxhaW5PYmplY3R9IGZyb20gJ2NsaWVudG5vZGUnXG5pbXBvcnQgKiBhcyBmaWxlU3lzdGVtIGZyb20gJ2ZzJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbi8vIE5PVEU6IE9ubHkgbmVlZGVkIGZvciBkZWJ1Z2dpbmcgdGhpcyBmaWxlLlxudHJ5IHtcbiAgICByZXF1aXJlKCdzb3VyY2UtbWFwLXN1cHBvcnQvcmVnaXN0ZXInKVxufSBjYXRjaCAoZXJyb3IpIHt9XG5cbmltcG9ydCBIZWxwZXIgZnJvbSAnLi9oZWxwZXIuY29tcGlsZWQnXG4vLyBOT1RFOiBcIntjb25maWd1cmF0aW9uIGFzIG1ldGFDb25maWd1cmF0aW9ufVwiIHdvdWxkIHJlc3VsdCBpbiBhIHJlYWQgb25seVxuLy8gdmFyaWFibGUgbmFtZWQgXCJtZXRhQ29uZmlndXJhdGlvblwiLlxuaW1wb3J0IHtjb25maWd1cmF0aW9uIGFzIGdpdmVuTWV0YUNvbmZpZ3VyYXRpb259IGZyb20gJy4vcGFja2FnZSdcbi8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzICovXG5pbXBvcnQgdHlwZSB7XG4gICAgRGVmYXVsdENvbmZpZ3VyYXRpb24sIEhUTUxDb25maWd1cmF0aW9uLCBJbnRlcm5hbEluamVjdGlvbixcbiAgICBNZXRhQ29uZmlndXJhdGlvbiwgUmVzb2x2ZWRDb25maWd1cmF0aW9uXG59IGZyb20gJy4vdHlwZSdcbi8qIGVzbGludC1lbmFibGUgbm8tdW51c2VkLXZhcnMgKi9cbmxldCBtZXRhQ29uZmlndXJhdGlvbjpNZXRhQ29uZmlndXJhdGlvbiA9IGdpdmVuTWV0YUNvbmZpZ3VyYXRpb25cbi8qXG4gICAgVG8gYXNzdW1lIHRvIGdvIHR3byBmb2xkZXIgdXAgZnJvbSB0aGlzIGZpbGUgdW50aWwgdGhlcmUgaXMgbm9cbiAgICBcIm5vZGVfbW9kdWxlc1wiIHBhcmVudCBmb2xkZXIgaXMgdXN1YWxseSByZXNpbGllbnQgYWdhaW4gZGVhbGluZyB3aXRoXG4gICAgcHJvamVjdHMgd2hlcmUgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSBpc24ndCB0aGUgcHJvamVjdHMgZGlyZWN0b3J5IGFuZFxuICAgIHRoaXMgbGlicmFyeSBpcyBsb2NhdGVkIGFzIGEgbmVzdGVkIGRlcGVuZGVuY3kuXG4qL1xubWV0YUNvbmZpZ3VyYXRpb24uZGVmYXVsdC5wYXRoLmNvbnRleHQgPSBfX2Rpcm5hbWVcbm1ldGFDb25maWd1cmF0aW9uLmRlZmF1bHQuY29udGV4dFR5cGUgPSAnbWFpbidcbndoaWxlICh0cnVlKSB7XG4gICAgbWV0YUNvbmZpZ3VyYXRpb24uZGVmYXVsdC5wYXRoLmNvbnRleHQgPSBwYXRoLnJlc29sdmUoXG4gICAgICAgIG1ldGFDb25maWd1cmF0aW9uLmRlZmF1bHQucGF0aC5jb250ZXh0LCAnLi4vLi4vJylcbiAgICBpZiAocGF0aC5iYXNlbmFtZShwYXRoLmRpcm5hbWUoXG4gICAgICAgIG1ldGFDb25maWd1cmF0aW9uLmRlZmF1bHQucGF0aC5jb250ZXh0XG4gICAgKSkgIT09ICdub2RlX21vZHVsZXMnKVxuICAgICAgICBicmVha1xufVxuaWYgKFxuICAgIHBhdGguYmFzZW5hbWUocGF0aC5kaXJuYW1lKHByb2Nlc3MuY3dkKCkpKSA9PT0gJ25vZGVfbW9kdWxlcycgfHxcbiAgICBwYXRoLmJhc2VuYW1lKHBhdGguZGlybmFtZShwcm9jZXNzLmN3ZCgpKSkgPT09ICcuc3RhZ2luZycgJiZcbiAgICBwYXRoLmJhc2VuYW1lKHBhdGguZGlybmFtZShwYXRoLmRpcm5hbWUocHJvY2Vzcy5jd2QoKSkpKSA9PT0gJ25vZGVfbW9kdWxlcydcbikge1xuICAgIC8qXG4gICAgICAgIE5PVEU6IElmIHdlIGFyZSBkZWFsaW5nIHdhcyBhIGRlcGVuZGVuY3kgcHJvamVjdCB1c2UgY3VycmVudCBkaXJlY3RvcnlcbiAgICAgICAgYXMgY29udGV4dC5cbiAgICAqL1xuICAgIG1ldGFDb25maWd1cmF0aW9uLmRlZmF1bHQucGF0aC5jb250ZXh0ID0gcHJvY2Vzcy5jd2QoKVxuICAgIG1ldGFDb25maWd1cmF0aW9uLmRlZmF1bHQuY29udGV4dFR5cGUgPSAnZGVwZW5kZW5jeSdcbn0gZWxzZVxuICAgIC8qXG4gICAgICAgIE5PVEU6IElmIHRoZSBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IHJlZmVyZW5jZXMgdGhpcyBmaWxlIHZpYSBhXG4gICAgICAgIGxpbmtlZCBcIm5vZGVfbW9kdWxlc1wiIGZvbGRlciB1c2luZyBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IGFzIGNvbnRleHRcbiAgICAgICAgaXMgYSBiZXR0ZXIgYXNzdW1wdGlvbiB0aGFuIHR3byBmb2xkZXJzIHVwIHRoZSBoaWVyYXJjaHkuXG4gICAgKi9cbiAgICB0cnkge1xuICAgICAgICBpZiAoZmlsZVN5c3RlbS5sc3RhdFN5bmMocGF0aC5qb2luKHByb2Nlc3MuY3dkKFxuICAgICAgICApLCAnbm9kZV9tb2R1bGVzJykpLmlzU3ltYm9saWNMaW5rKCkpXG4gICAgICAgICAgICBtZXRhQ29uZmlndXJhdGlvbi5kZWZhdWx0LnBhdGguY29udGV4dCA9IHByb2Nlc3MuY3dkKClcbiAgICB9IGNhdGNoIChlcnJvcikge31cbmxldCBzcGVjaWZpY0NvbmZpZ3VyYXRpb246UGxhaW5PYmplY3RcbnRyeSB7XG4gICAgLyogZXNsaW50LWRpc2FibGUgbm8tZXZhbCAqL1xuICAgIHNwZWNpZmljQ29uZmlndXJhdGlvbiA9IGV2YWwoJ3JlcXVpcmUnKShwYXRoLmpvaW4oXG4gICAgICAgIG1ldGFDb25maWd1cmF0aW9uLmRlZmF1bHQucGF0aC5jb250ZXh0LCAncGFja2FnZScpKVxuICAgIC8qIGVzbGludC1lbmFibGUgbm8tZXZhbCAqL1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBzcGVjaWZpY0NvbmZpZ3VyYXRpb24gPSB7bmFtZTogJ21vY2t1cCd9XG4gICAgbWV0YUNvbmZpZ3VyYXRpb24uZGVmYXVsdC5wYXRoLmNvbnRleHQgPSBwcm9jZXNzLmN3ZCgpXG59XG5jb25zdCBuYW1lOnN0cmluZyA9IHNwZWNpZmljQ29uZmlndXJhdGlvbi5uYW1lXG5zcGVjaWZpY0NvbmZpZ3VyYXRpb24gPSBzcGVjaWZpY0NvbmZpZ3VyYXRpb24ud2ViT3B0aW1pemVyIHx8IHt9XG5zcGVjaWZpY0NvbmZpZ3VyYXRpb24ubmFtZSA9IG5hbWVcbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIGxvYWRpbmcgZGVmYXVsdCBjb25maWd1cmF0aW9uXG4vLyBOT1RFOiBHaXZlbiBub2RlIGNvbW1hbmQgbGluZSBhcmd1bWVudHMgcmVzdWx0cyBpbiBcIm5wbV9jb25maWdfKlwiXG4vLyBlbnZpcm9ubWVudCB2YXJpYWJsZXMuXG5sZXQgZGVidWc6Ym9vbGVhbiA9IG1ldGFDb25maWd1cmF0aW9uLmRlZmF1bHQuZGVidWdcbmlmIChzcGVjaWZpY0NvbmZpZ3VyYXRpb24uZGVidWcgIT09IHVuZGVmaW5lZClcbiAgICBkZWJ1ZyA9IHNwZWNpZmljQ29uZmlndXJhdGlvbi5kZWJ1Z1xuaWYgKHByb2Nlc3MuZW52Lm5wbV9jb25maWdfcHJvZHVjdGlvbilcbiAgICBkZWJ1ZyA9IGZhbHNlXG5lbHNlIGlmIChwcm9jZXNzLmVudi5ucG1fY29uZmlnX2RlYnVnKVxuICAgIGRlYnVnID0gdHJ1ZVxubWV0YUNvbmZpZ3VyYXRpb24uZGVmYXVsdC5wYXRoLmNvbnRleHQgKz0gJy8nXG4vLyBNZXJnZXMgZmluYWwgZGVmYXVsdCBjb25maWd1cmF0aW9uIG9iamVjdCBkZXBlbmRpbmcgb24gZ2l2ZW4gdGFyZ2V0XG4vLyBlbnZpcm9ubWVudC5cbmNvbnN0IGxpYnJhcnlDb25maWd1cmF0aW9uOlBsYWluT2JqZWN0ID0gbWV0YUNvbmZpZ3VyYXRpb24ubGlicmFyeVxubGV0IGNvbmZpZ3VyYXRpb246RGVmYXVsdENvbmZpZ3VyYXRpb25cbmlmIChkZWJ1ZylcbiAgICBjb25maWd1cmF0aW9uID0gVG9vbHMuZXh0ZW5kT2JqZWN0KHRydWUsIFRvb2xzLm1vZGlmeU9iamVjdChcbiAgICAgICAgbWV0YUNvbmZpZ3VyYXRpb24uZGVmYXVsdCwgbWV0YUNvbmZpZ3VyYXRpb24uZGVidWdcbiAgICApLCBtZXRhQ29uZmlndXJhdGlvbi5kZWJ1ZylcbmVsc2VcbiAgICBjb25maWd1cmF0aW9uID0gbWV0YUNvbmZpZ3VyYXRpb24uZGVmYXVsdFxuY29uZmlndXJhdGlvbi5kZWJ1ZyA9IGRlYnVnXG5pZiAodHlwZW9mIGNvbmZpZ3VyYXRpb24ubGlicmFyeSA9PT0gJ29iamVjdCcpXG4gICAgVG9vbHMuZXh0ZW5kT2JqZWN0KHRydWUsIFRvb2xzLm1vZGlmeU9iamVjdChcbiAgICAgICAgbGlicmFyeUNvbmZpZ3VyYXRpb24sIGNvbmZpZ3VyYXRpb24ubGlicmFyeVxuICAgICksIGNvbmZpZ3VyYXRpb24ubGlicmFyeSlcbmlmIChcbiAgICAnbGlicmFyeScgaW4gc3BlY2lmaWNDb25maWd1cmF0aW9uICYmXG4gICAgc3BlY2lmaWNDb25maWd1cmF0aW9uLmxpYnJhcnkgPT09IHRydWUgfHwgKFxuICAgICAgICAnbGlicmFyeScgaW4gc3BlY2lmaWNDb25maWd1cmF0aW9uICYmXG4gICAgICAgIHNwZWNpZmljQ29uZmlndXJhdGlvbi5saWJyYXJ5ID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgISgnbGlicmFyeScgaW4gc3BlY2lmaWNDb25maWd1cmF0aW9uKVxuICAgICkgJiYgY29uZmlndXJhdGlvbi5saWJyYXJ5XG4pXG4gICAgY29uZmlndXJhdGlvbiA9IFRvb2xzLmV4dGVuZE9iamVjdCh0cnVlLCBUb29scy5tb2RpZnlPYmplY3QoXG4gICAgICAgIGNvbmZpZ3VyYXRpb24sIGxpYnJhcnlDb25maWd1cmF0aW9uXG4gICAgKSwgbGlicmFyeUNvbmZpZ3VyYXRpb24pXG4vLyBlbmRyZWdpb25cbi8qXG4gICAgcmVnaW9uIG1lcmdpbmcgYW5kIGV2YWx1YXRpbmcgZGVmYXVsdCwgdGVzdCwgZG9jdW1lbnQsIHNwZWNpZmljIGFuZCBkeW5hbWljXG4gICAgc2V0dGluZ3NcbiovXG4vLyAvIHJlZ2lvbiBsb2FkIGFkZGl0aW9uYWwgZHluYW1pY2FsbHkgZ2l2ZW4gY29uZmlndXJhdGlvblxubGV0IGNvdW50Om51bWJlciA9IDBcbmxldCBmaWxlUGF0aDo/c3RyaW5nID0gbnVsbFxud2hpbGUgKHRydWUpIHtcbiAgICBjb25zdCBuZXdGaWxlUGF0aDpzdHJpbmcgPSBjb25maWd1cmF0aW9uLnBhdGguY29udGV4dCArXG4gICAgICAgIGAuZHluYW1pY0NvbmZpZ3VyYXRpb24tJHtjb3VudH0uanNvbmBcbiAgICBpZiAoIVRvb2xzLmlzRmlsZVN5bmMobmV3RmlsZVBhdGgpKVxuICAgICAgICBicmVha1xuICAgIGZpbGVQYXRoID0gbmV3RmlsZVBhdGhcbiAgICBjb3VudCArPSAxXG59XG5sZXQgcnVudGltZUluZm9ybWF0aW9uOlBsYWluT2JqZWN0ID0ge1xuICAgIGdpdmVuQ29tbWFuZExpbmVBcmd1bWVudHM6IHByb2Nlc3MuYXJndlxufVxuaWYgKGZpbGVQYXRoKSB7XG4gICAgcnVudGltZUluZm9ybWF0aW9uID0gSlNPTi5wYXJzZShmaWxlU3lzdGVtLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwge1xuICAgICAgICBlbmNvZGluZzogKGNvbmZpZ3VyYXRpb24uZW5jb2Rpbmc6c3RyaW5nKX0pKVxuICAgIGZpbGVTeXN0ZW0udW5saW5rKGZpbGVQYXRoLCAoZXJyb3I6P0Vycm9yKTp2b2lkID0+IHtcbiAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgdGhyb3cgZXJyb3JcbiAgICB9KVxufVxuaWYgKHJ1bnRpbWVJbmZvcm1hdGlvbi5naXZlbkNvbW1hbmRMaW5lQXJndW1lbnRzLmxlbmd0aCA+IDIpXG4gICAgLy8gcmVnaW9uIGFwcGx5IHVzZSBjYXNlIHNwZWNpZmljIGNvbmZpZ3VyYXRpb25cbiAgICBmb3IgKGNvbnN0IHR5cGU6c3RyaW5nIG9mIFsnZG9jdW1lbnQnLCAndGVzdCcsICd0ZXN0SW5Ccm93c2VyJ10pXG4gICAgICAgIGlmIChydW50aW1lSW5mb3JtYXRpb24uZ2l2ZW5Db21tYW5kTGluZUFyZ3VtZW50c1syXSA9PT0gdHlwZSlcbiAgICAgICAgICAgIFRvb2xzLmV4dGVuZE9iamVjdCh0cnVlLCBUb29scy5tb2RpZnlPYmplY3QoXG4gICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbiwgY29uZmlndXJhdGlvblt0eXBlXVxuICAgICAgICAgICAgKSwgY29uZmlndXJhdGlvblt0eXBlXSlcbiAgICAvLyBlbmRyZWdpb25cbmZvciAoY29uc3QgdHlwZTpzdHJpbmcgb2YgWydkb2N1bWVudCcsICd0ZXN0JywgJ3Rlc3RJbkJyb3dzZXInXSlcbiAgICBkZWxldGUgY29uZmlndXJhdGlvblt0eXBlXVxuLy8gLyBlbmRyZWdpb25cblRvb2xzLmV4dGVuZE9iamVjdCh0cnVlLCBUb29scy5tb2RpZnlPYmplY3QoVG9vbHMubW9kaWZ5T2JqZWN0KFxuICAgIGNvbmZpZ3VyYXRpb24sIHNwZWNpZmljQ29uZmlndXJhdGlvblxuKSwgcnVudGltZUluZm9ybWF0aW9uKSwgc3BlY2lmaWNDb25maWd1cmF0aW9uLCBydW50aW1lSW5mb3JtYXRpb24pXG5sZXQgcmVzdWx0Oj9QbGFpbk9iamVjdCA9IG51bGxcbmlmIChydW50aW1lSW5mb3JtYXRpb24uZ2l2ZW5Db21tYW5kTGluZUFyZ3VtZW50cy5sZW5ndGggPiAzKVxuICAgIHJlc3VsdCA9IFRvb2xzLnN0cmluZ1BhcnNlRW5jb2RlZE9iamVjdChcbiAgICAgICAgcnVudGltZUluZm9ybWF0aW9uLmdpdmVuQ29tbWFuZExpbmVBcmd1bWVudHNbcnVudGltZUluZm9ybWF0aW9uXG4gICAgICAgICAgICAuZ2l2ZW5Db21tYW5kTGluZUFyZ3VtZW50cy5sZW5ndGggLSAxXSxcbiAgICAgICAgY29uZmlndXJhdGlvbiwgJ2NvbmZpZ3VyYXRpb24nKVxuaWYgKFRvb2xzLmlzUGxhaW5PYmplY3QocmVzdWx0KSlcbiAgICBUb29scy5leHRlbmRPYmplY3QodHJ1ZSwgVG9vbHMubW9kaWZ5T2JqZWN0KGNvbmZpZ3VyYXRpb24sIHJlc3VsdCksIHJlc3VsdClcbi8vIC8gcmVnaW9uIGRldGVybWluZSBleGlzdGluZyBwcmUgY29tcGlsZWQgZGxsIG1hbmlmZXN0cyBmaWxlIHBhdGhzXG5jb25maWd1cmF0aW9uLmRsbE1hbmlmZXN0RmlsZVBhdGhzID0gW11cbmlmIChUb29scy5pc0RpcmVjdG9yeVN5bmMoY29uZmlndXJhdGlvbi5wYXRoLnRhcmdldC5iYXNlKSlcbiAgICBmb3IgKGNvbnN0IGZpbGVOYW1lOnN0cmluZyBvZiBmaWxlU3lzdGVtLnJlYWRkaXJTeW5jKFxuICAgICAgICBjb25maWd1cmF0aW9uLnBhdGgudGFyZ2V0LmJhc2VcbiAgICApKVxuICAgICAgICBpZiAoZmlsZU5hbWUubWF0Y2goL14uKlxcLmRsbC1tYW5pZmVzdFxcLmpzb24kLykpXG4gICAgICAgICAgICBjb25maWd1cmF0aW9uLmRsbE1hbmlmZXN0RmlsZVBhdGhzLnB1c2gocGF0aC5yZXNvbHZlKFxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aC50YXJnZXQuYmFzZSwgZmlsZU5hbWUpKVxuLy8gLyBlbmRyZWdpb25cbi8vIC8gcmVnaW9uIGRlZmluZSBkeW5hbWljIHJlc29sdmUgcGFyYW1ldGVyXG5jb25zdCBwYXJhbWV0ZXJEZXNjcmlwdGlvbjpBcnJheTxzdHJpbmc+ID0gW1xuICAgICdjdXJyZW50UGF0aCcsICdmaWxlU3lzdGVtJywgJ0hlbHBlcicsICdwYXRoJywgJ3JlcXVpcmUnLCAnVG9vbHMnLFxuICAgICd3ZWJPcHRpbWl6ZXJQYXRoJ11cbmNvbnN0IHBhcmFtZXRlcjpBcnJheTxhbnk+ID0gW1xuICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWV2YWwgKi9cbiAgICBwcm9jZXNzLmN3ZCgpLCBmaWxlU3lzdGVtLCBIZWxwZXIsIHBhdGgsIGV2YWwoJ3JlcXVpcmUnKSwgVG9vbHMsIF9fZGlybmFtZV1cbiAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLWV2YWwgKi9cbi8vIC8gZW5kcmVnaW9uXG4vLyAvIHJlZ2lvbiBidWlsZCBhYnNvbHV0ZSBwYXRoc1xuY29uZmlndXJhdGlvbi5wYXRoLmJhc2UgPSBwYXRoLnJlc29sdmUoXG4gICAgY29uZmlndXJhdGlvbi5wYXRoLmNvbnRleHQsIGNvbmZpZ3VyYXRpb24ucGF0aC5iYXNlKVxuZm9yIChjb25zdCBrZXk6c3RyaW5nIGluIGNvbmZpZ3VyYXRpb24ucGF0aClcbiAgICBpZiAoXG4gICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aC5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIGtleSAhPT0gJ2Jhc2UnICYmXG4gICAgICAgIHR5cGVvZiBjb25maWd1cmF0aW9uLnBhdGhba2V5XSA9PT0gJ3N0cmluZydcbiAgICApXG4gICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldID0gcGF0aC5yZXNvbHZlKFxuICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmJhc2UsIGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldXG4gICAgICAgICkgKyAnLydcbiAgICBlbHNlIGlmIChUb29scy5pc1BsYWluT2JqZWN0KGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldKSkge1xuICAgICAgICBjb25maWd1cmF0aW9uLnBhdGhba2V5XS5iYXNlID0gcGF0aC5yZXNvbHZlKFxuICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmJhc2UsIGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldLmJhc2UpXG4gICAgICAgIGZvciAoY29uc3Qgc3ViS2V5OnN0cmluZyBpbiBjb25maWd1cmF0aW9uLnBhdGhba2V5XSlcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGhba2V5XS5oYXNPd25Qcm9wZXJ0eShzdWJLZXkpICYmXG4gICAgICAgICAgICAgICAgIVsnYmFzZScsICdwdWJsaWMnXS5pbmNsdWRlcyhzdWJLZXkpICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldW3N1YktleV0gPT09ICdzdHJpbmcnXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoW2tleV1bc3ViS2V5XSA9IHBhdGgucmVzb2x2ZShcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoW2tleV0uYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoW2tleV1bc3ViS2V5XVxuICAgICAgICAgICAgICAgICkgKyAnLydcbiAgICAgICAgICAgIGVsc2UgaWYgKFRvb2xzLmlzUGxhaW5PYmplY3QoY29uZmlndXJhdGlvbi5wYXRoW2tleV1bc3ViS2V5XSkpIHtcbiAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGhba2V5XVtzdWJLZXldLmJhc2UgPSBwYXRoLnJlc29sdmUoXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldLmJhc2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldW3N1YktleV0uYmFzZSlcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN1YlN1YktleTpzdHJpbmcgaW4gY29uZmlndXJhdGlvbi5wYXRoW2tleV1bc3ViS2V5XSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldW3N1YktleV0uaGFzT3duUHJvcGVydHkoXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJTdWJLZXlcbiAgICAgICAgICAgICAgICAgICAgKSAmJiBzdWJTdWJLZXkgIT09ICdiYXNlJyAmJlxuICAgICAgICAgICAgICAgICAgICB0eXBlb2YgY29uZmlndXJhdGlvbi5wYXRoW2tleV1bc3ViS2V5XVtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlN1YktleVxuICAgICAgICAgICAgICAgICAgICBdID09PSAnc3RyaW5nJylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldW3N1YktleV1bXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViU3ViS2V5XG4gICAgICAgICAgICAgICAgICAgICAgICBdID0gcGF0aC5yZXNvbHZlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGF0aFtrZXldW3N1YktleV0uYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uLnBhdGhba2V5XVtzdWJLZXldW3N1YlN1YktleV1cbiAgICAgICAgICAgICAgICAgICAgICAgICkgKyAnLydcbiAgICAgICAgICAgIH1cbiAgICB9XG4vLyAvIGVuZHJlZ2lvblxuY29uc3QgcmVzb2x2ZWRDb25maWd1cmF0aW9uOlJlc29sdmVkQ29uZmlndXJhdGlvbiA9XG4gICAgVG9vbHMucmVzb2x2ZUR5bmFtaWNEYXRhU3RydWN0dXJlKFxuICAgICAgICBjb25maWd1cmF0aW9uLCBwYXJhbWV0ZXJEZXNjcmlwdGlvbiwgcGFyYW1ldGVyKVxuLy8gZW5kcmVnaW9uXG4vLyByZWdpb24gY29uc29saWRhdGUgZmlsZSBzcGVjaWZpYyBidWlsZCBjb25maWd1cmF0aW9uXG4vLyBBcHBseSBkZWZhdWx0IGZpbGUgbGV2ZWwgYnVpbGQgY29uZmlndXJhdGlvbnMgdG8gYWxsIGZpbGUgdHlwZSBzcGVjaWZpY1xuLy8gb25lcy5cbmNvbnN0IGRlZmF1bHRDb25maWd1cmF0aW9uOlBsYWluT2JqZWN0ID1cbiAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24uYnVpbGQudHlwZXMuZGVmYXVsdFxuZGVsZXRlIHJlc29sdmVkQ29uZmlndXJhdGlvbi5idWlsZC50eXBlcy5kZWZhdWx0XG5mb3IgKGNvbnN0IHR5cGU6c3RyaW5nIGluIHJlc29sdmVkQ29uZmlndXJhdGlvbi5idWlsZC50eXBlcylcbiAgICBpZiAocmVzb2x2ZWRDb25maWd1cmF0aW9uLmJ1aWxkLnR5cGVzLmhhc093blByb3BlcnR5KHR5cGUpKVxuICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24uYnVpbGQudHlwZXNbdHlwZV0gPSBUb29scy5leHRlbmRPYmplY3QodHJ1ZSwge1xuICAgICAgICB9LCBkZWZhdWx0Q29uZmlndXJhdGlvbiwgVG9vbHMuZXh0ZW5kT2JqZWN0KFxuICAgICAgICAgICAgdHJ1ZSwge2V4dGVuc2lvbjogdHlwZX0sIHJlc29sdmVkQ29uZmlndXJhdGlvbi5idWlsZC50eXBlc1t0eXBlXSxcbiAgICAgICAgICAgIHt0eXBlfSkpXG4vLyBlbmRyZWdpb25cbi8vIHJlZ2lvbiByZXNvbHZlIG1vZHVsZSBsb2NhdGlvbiBhbmQgZGV0ZXJtaW5lIHdoaWNoIGFzc2V0IHR5cGVzIGFyZSBuZWVkZWRcbnJlc29sdmVkQ29uZmlndXJhdGlvbi5tb2R1bGUubG9jYXRpb25zID0gSGVscGVyLmRldGVybWluZU1vZHVsZUxvY2F0aW9ucyhcbiAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24uaW5qZWN0aW9uLmludGVybmFsLFxuICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5tb2R1bGUuYWxpYXNlcyxcbiAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ubW9kdWxlLnJlcGxhY2VtZW50cy5ub3JtYWwsXG4gICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLmV4dGVuc2lvbnMsIHJlc29sdmVkQ29uZmlndXJhdGlvbi5wYXRoLmNvbnRleHQsXG4gICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLnBhdGguc291cmNlLmFzc2V0LmJhc2UpXG5yZXNvbHZlZENvbmZpZ3VyYXRpb24uaW5qZWN0aW9uID0gSGVscGVyLnJlc29sdmVJbmplY3Rpb24oXG4gICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLmluamVjdGlvbiwgSGVscGVyLnJlc29sdmVCdWlsZENvbmZpZ3VyYXRpb25GaWxlUGF0aHMoXG4gICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5idWlsZC50eXBlcyxcbiAgICAgICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLnBhdGguc291cmNlLmFzc2V0LmJhc2UsXG4gICAgICAgIEhlbHBlci5ub3JtYWxpemVQYXRocyhyZXNvbHZlZENvbmZpZ3VyYXRpb24ucGF0aC5pZ25vcmUuY29uY2F0KFxuICAgICAgICAgICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLm1vZHVsZS5kaXJlY3RvcnlOYW1lcyxcbiAgICAgICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5sb2FkZXIuZGlyZWN0b3J5TmFtZXNcbiAgICAgICAgKS5tYXAoKGZpbGVQYXRoOnN0cmluZyk6c3RyaW5nID0+IHBhdGgucmVzb2x2ZShcbiAgICAgICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5wYXRoLmNvbnRleHQsIGZpbGVQYXRoKVxuICAgICAgICApLmZpbHRlcigoZmlsZVBhdGg6c3RyaW5nKTpib29sZWFuID0+XG4gICAgICAgICAgICAhcmVzb2x2ZWRDb25maWd1cmF0aW9uLnBhdGguY29udGV4dC5zdGFydHNXaXRoKGZpbGVQYXRoKSkpLFxuICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGFja2FnZS5tYWluLmZpbGVOYW1lc1xuICAgICksIHJlc29sdmVkQ29uZmlndXJhdGlvbi5pbmplY3Rpb24uYXV0b0V4Y2x1ZGUsXG4gICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLm1vZHVsZS5hbGlhc2VzLFxuICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5tb2R1bGUucmVwbGFjZW1lbnRzLm5vcm1hbCxcbiAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24uZXh0ZW5zaW9ucyxcbiAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGF0aC5jb250ZXh0LFxuICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5wYXRoLnNvdXJjZS5hc3NldC5iYXNlLFxuICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5wYXRoLmlnbm9yZSlcbmNvbnN0IGludGVybmFsSW5qZWN0aW9uOkludGVybmFsSW5qZWN0aW9uID1cbiAgICAvLyBJZ25vcmVUeXBlQ2hlY2tcbiAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24uaW5qZWN0aW9uLmludGVybmFsXG5yZXNvbHZlZENvbmZpZ3VyYXRpb24uaW5qZWN0aW9uLmludGVybmFsID0ge1xuICAgIGdpdmVuOiByZXNvbHZlZENvbmZpZ3VyYXRpb24uaW5qZWN0aW9uLmludGVybmFsLFxuICAgIG5vcm1hbGl6ZWQ6IEhlbHBlci5yZXNvbHZlTW9kdWxlc0luRm9sZGVycyhcbiAgICAgICAgSGVscGVyLm5vcm1hbGl6ZUludGVybmFsSW5qZWN0aW9uKGludGVybmFsSW5qZWN0aW9uKSxcbiAgICAgICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLm1vZHVsZS5hbGlhc2VzLFxuICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ubW9kdWxlLnJlcGxhY2VtZW50cy5ub3JtYWwsXG4gICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5leHRlbnNpb25zLFxuICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGF0aC5jb250ZXh0LFxuICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGF0aC5zb3VyY2UuYXNzZXQuYmFzZSxcbiAgICAgICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLnBhdGguaWdub3JlLmNvbmNhdChcbiAgICAgICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5tb2R1bGUuZGlyZWN0b3J5TmFtZXMsXG4gICAgICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ubG9hZGVyLmRpcmVjdG9yeU5hbWVzXG4gICAgICAgICkubWFwKChmaWxlUGF0aDpzdHJpbmcpOnN0cmluZyA9PiBwYXRoLnJlc29sdmUoXG4gICAgICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGF0aC5jb250ZXh0LCBmaWxlUGF0aClcbiAgICAgICAgKS5maWx0ZXIoKGZpbGVQYXRoOnN0cmluZyk6Ym9vbGVhbiA9PlxuICAgICAgICAgICAgIXJlc29sdmVkQ29uZmlndXJhdGlvbi5wYXRoLmNvbnRleHQuc3RhcnRzV2l0aChmaWxlUGF0aCkpKX1cbnJlc29sdmVkQ29uZmlndXJhdGlvbi5uZWVkZWQgPSB7amF2YVNjcmlwdDogY29uZmlndXJhdGlvbi5kZWJ1ZyAmJiBbXG4gICAgJ3NlcnZlJywgJ3Rlc3RJbkJyb3dzZXInXG5dLmluY2x1ZGVzKHJlc29sdmVkQ29uZmlndXJhdGlvbi5naXZlbkNvbW1hbmRMaW5lQXJndW1lbnRzWzJdKX1cbmZvciAoXG4gICAgY29uc3QgY2h1bmtOYW1lOnN0cmluZyBpblxuICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5pbmplY3Rpb24uaW50ZXJuYWwubm9ybWFsaXplZFxuKVxuICAgIGlmIChyZXNvbHZlZENvbmZpZ3VyYXRpb24uaW5qZWN0aW9uLmludGVybmFsLm5vcm1hbGl6ZWQuaGFzT3duUHJvcGVydHkoXG4gICAgICAgIGNodW5rTmFtZVxuICAgICkpXG4gICAgICAgIGZvciAoXG4gICAgICAgICAgICBjb25zdCBtb2R1bGVJRDpzdHJpbmcgb2ZcbiAgICAgICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5pbmplY3Rpb24uaW50ZXJuYWwubm9ybWFsaXplZFtjaHVua05hbWVdXG4gICAgICAgICkge1xuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGg6P3N0cmluZyA9IEhlbHBlci5kZXRlcm1pbmVNb2R1bGVGaWxlUGF0aChcbiAgICAgICAgICAgICAgICBtb2R1bGVJRCwgcmVzb2x2ZWRDb25maWd1cmF0aW9uLm1vZHVsZS5hbGlhc2VzLFxuICAgICAgICAgICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5tb2R1bGUucmVwbGFjZW1lbnRzLm5vcm1hbCxcbiAgICAgICAgICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24uZXh0ZW5zaW9ucyxcbiAgICAgICAgICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGF0aC5jb250ZXh0LFxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIE5PVEU6IFdlIGRvZXNuJ3QgdXNlXG4gICAgICAgICAgICAgICAgICAgIFwicmVzb2x2ZWRDb25maWd1cmF0aW9uLnBhdGguc291cmNlLmFzc2V0LmJhc2VcIiBiZWNhdXNlIHdlXG4gICAgICAgICAgICAgICAgICAgIGhhdmUgYWxyZWFkeSByZXNvbHZlIGFsbCBtb2R1bGUgaWRzLlxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgJy4vJyxcbiAgICAgICAgICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGF0aC5pZ25vcmUsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLm1vZHVsZS5kaXJlY3RvcnlOYW1lcyxcbiAgICAgICAgICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGFja2FnZS5tYWluLmZpbGVOYW1lcyxcbiAgICAgICAgICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ucGFja2FnZS5tYWluLnByb3BlcnR5TmFtZXMsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLnBhY2thZ2UuYWxpYXNQcm9wZXJ0eU5hbWVzLFxuICAgICAgICAgICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5lbmNvZGluZylcbiAgICAgICAgICAgIGxldCB0eXBlOj9zdHJpbmdcbiAgICAgICAgICAgIGlmIChmaWxlUGF0aClcbiAgICAgICAgICAgICAgICB0eXBlID0gSGVscGVyLmRldGVybWluZUFzc2V0VHlwZShcbiAgICAgICAgICAgICAgICAgICAgZmlsZVBhdGgsIHJlc29sdmVkQ29uZmlndXJhdGlvbi5idWlsZC50eXBlcyxcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLnBhdGgpXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgICAgICBgR2l2ZW4gcmVxdWVzdCBcIiR7bW9kdWxlSUR9XCIgY291bGRuJ3QgYmUgcmVzb2x2ZWQuYClcbiAgICAgICAgICAgIGlmICh0eXBlKVxuICAgICAgICAgICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5uZWVkZWRbdHlwZV0gPSB0cnVlXG4gICAgICAgIH1cbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIGFkZGluZyBzcGVjaWFsIGFsaWFzZXNcbi8vIE5PVEU6IFRoaXMgYWxpYXMgY291bGRuJ3QgYmUgc2V0IGluIHRoZSBcInBhY2thZ2UuanNvblwiIGZpbGUgc2luY2UgdGhpcyB3b3VsZFxuLy8gcmVzdWx0IGluIGFuIGVuZGxlc3MgbG9vcC5cbnJlc29sdmVkQ29uZmlndXJhdGlvbi5sb2FkZXIuYWxpYXNlcy53ZWJPcHRpbWl6ZXJEZWZhdWx0VGVtcGxhdGVGaWxlTG9hZGVyID0gJydcbmZvciAoXG4gICAgY29uc3QgbG9hZGVyOlBsYWluT2JqZWN0IG9mXG4gICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLmZpbGVzLmRlZmF1bHRIVE1MLnRlbXBsYXRlLnVzZVxuKSB7XG4gICAgaWYgKFxuICAgICAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24ubG9hZGVyLmFsaWFzZXNcbiAgICAgICAgLndlYk9wdGltaXplckRlZmF1bHRUZW1wbGF0ZUZpbGVMb2FkZXJcbiAgICApXG4gICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5sb2FkZXIuYWxpYXNlc1xuICAgICAgICAgICAgLndlYk9wdGltaXplckRlZmF1bHRUZW1wbGF0ZUZpbGVMb2FkZXIgKz0gJyEnXG4gICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLmxvYWRlci5hbGlhc2VzXG4gICAgICAgIC53ZWJPcHRpbWl6ZXJEZWZhdWx0VGVtcGxhdGVGaWxlTG9hZGVyICs9IGxvYWRlci5sb2FkZXJcbiAgICBpZiAobG9hZGVyLm9wdGlvbnMpXG4gICAgICAgIHJlc29sdmVkQ29uZmlndXJhdGlvbi5sb2FkZXIuYWxpYXNlc1xuICAgICAgICAgICAgLndlYk9wdGltaXplckRlZmF1bHRUZW1wbGF0ZUZpbGVMb2FkZXIgKz0gJz8nICtcbiAgICAgICAgICAgICAgICBUb29scy5jb252ZXJ0Q2lyY3VsYXJPYmplY3RUb0pTT04obG9hZGVyLm9wdGlvbnMpXG59XG5yZXNvbHZlZENvbmZpZ3VyYXRpb24ubW9kdWxlLmFsaWFzZXMud2ViT3B0aW1pemVyRGVmYXVsdFRlbXBsYXRlRmlsZVBhdGgkID1cbiAgICByZXNvbHZlZENvbmZpZ3VyYXRpb24uZmlsZXMuZGVmYXVsdEhUTUwudGVtcGxhdGUuZmlsZVBhdGhcbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIGFwcGx5IGh0bWwgd2VicGFjayBwbHVnaW4gd29ya2Fyb3VuZHNcbi8qXG4gICAgTk9URTogUHJvdmlkZXMgYSB3b3JrYXJvdW5kIHRvIGhhbmRsZSBhIGJ1ZyB3aXRoIGNoYWluZWQgbG9hZGVyXG4gICAgY29uZmlndXJhdGlvbnMuXG4qL1xuZm9yIChcbiAgICBsZXQgaHRtbENvbmZpZ3VyYXRpb246SFRNTENvbmZpZ3VyYXRpb24gb2YgcmVzb2x2ZWRDb25maWd1cmF0aW9uLmZpbGVzLmh0bWxcbikge1xuICAgIFRvb2xzLmV4dGVuZE9iamVjdChcbiAgICAgICAgdHJ1ZSwgaHRtbENvbmZpZ3VyYXRpb24sIHJlc29sdmVkQ29uZmlndXJhdGlvbi5maWxlcy5kZWZhdWx0SFRNTClcbiAgICBodG1sQ29uZmlndXJhdGlvbi50ZW1wbGF0ZS5yZXF1ZXN0ID0gaHRtbENvbmZpZ3VyYXRpb24udGVtcGxhdGUuZmlsZVBhdGhcbiAgICBpZiAoXG4gICAgICAgIGh0bWxDb25maWd1cmF0aW9uLnRlbXBsYXRlLmZpbGVQYXRoICE9PVxuICAgICAgICAgICAgcmVzb2x2ZWRDb25maWd1cmF0aW9uLmZpbGVzLmRlZmF1bHRIVE1MLnRlbXBsYXRlLmZpbGVQYXRoICYmXG4gICAgICAgIGh0bWxDb25maWd1cmF0aW9uLnRlbXBsYXRlLm9wdGlvbnNcbiAgICApIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdFN0cmluZzpPYmplY3QgPSBuZXcgU3RyaW5nKFxuICAgICAgICAgICAgaHRtbENvbmZpZ3VyYXRpb24udGVtcGxhdGUucmVxdWVzdCArXG4gICAgICAgICAgICBUb29scy5jb252ZXJ0Q2lyY3VsYXJPYmplY3RUb0pTT04oXG4gICAgICAgICAgICAgICAgaHRtbENvbmZpZ3VyYXRpb24udGVtcGxhdGUub3B0aW9ucykpXG4gICAgICAgIHJlcXVlc3RTdHJpbmcucmVwbGFjZSA9ICgoc3RyaW5nOnN0cmluZyk6RnVuY3Rpb24gPT4gKFxuICAgICAgICAgICAgX3NlYXJjaDpSZWdFeHB8c3RyaW5nLCBfcmVwbGFjZW1lbnQ6c3RyaW5nfChcbiAgICAgICAgICAgICAgICAuLi5tYXRjaGVzOkFycmF5PHN0cmluZz5cbiAgICAgICAgICAgICkgPT4gc3RyaW5nXG4gICAgICAgICk6c3RyaW5nID0+IHN0cmluZykoaHRtbENvbmZpZ3VyYXRpb24udGVtcGxhdGUuZmlsZVBhdGgpXG4gICAgICAgIGh0bWxDb25maWd1cmF0aW9uLnRlbXBsYXRlLnJlcXVlc3QgPSByZXF1ZXN0U3RyaW5nXG4gICAgfVxufVxuLy8gZW5kcmVnaW9uXG5leHBvcnQgZGVmYXVsdCByZXNvbHZlZENvbmZpZ3VyYXRpb25cbi8vIHJlZ2lvbiB2aW0gbW9kbGluZVxuLy8gdmltOiBzZXQgdGFic3RvcD00IHNoaWZ0d2lkdGg9NCBleHBhbmR0YWI6XG4vLyB2aW06IGZvbGRtZXRob2Q9bWFya2VyIGZvbGRtYXJrZXI9cmVnaW9uLGVuZHJlZ2lvbjpcbi8vIGVuZHJlZ2lvblxuIl19