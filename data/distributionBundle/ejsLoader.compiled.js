#!/usr/bin/env node
'use strict';var _clientnode=require('clientnode'),_clientnode2=_interopRequireDefault(_clientnode),_fs=require('fs'),fileSystem=_interopRequireWildcard(_fs),_loaderUtils=require('loader-utils'),loaderUtils=_interopRequireWildcard(_loaderUtils),_ejs=require('ejs'),ejs=_interopRequireWildcard(_ejs),_configurator=require('./configurator.compiled'),_configurator2=_interopRequireDefault(_configurator),_helper=require('./helper.compiled'),_helper2=_interopRequireDefault(_helper);function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}try{require('source-map-support/register')}catch(a){}module.exports=function(a){this.cacheable&&this.cacheable();const b=_clientnode2.default.convertSubstringInPlainObject(_clientnode2.default.extendObject(!0,{context:'./',extensions:{file:{external:['.js'],internal:['.js','.css','.svg','.png','.jpg','.gif','.ico','.html','.json','.eot','.ttf','.woff']},module:[]},module:{aliases:{},replacements:{}},compileSteps:2},this.options||{},loaderUtils.getOptions(this)||{}),/#%%%#/g,'!'),c=(d,e=b.compiler,f=2)=>(g={})=>{e=_clientnode2.default.extendObject(!0,{filename:d},e);const h=(k)=>{const l=k.replace(/^(.+)\?[^?]+$/,'$1'),m=k.match(/^[^?]+\?(.+)$/,'$1');let n={};if(m){n=((r,s,t,u,v)=>new Function('request','template','source','compile','locals',`return ${m[1]}`)(r,s,t,u,v))(k,l,a,c,g)}let o=_clientnode2.default.copyLimitedRecursively(e);if(delete o.client,o=_clientnode2.default.extendObject(!0,{encoding:'utf-8'},o,n.options||{}),o.isString)return c(l,o)(n);const p=_helper2.default.determineModuleFilePath(l,b.module.aliases,b.module.replacements,b.extensions,b.context,_configurator2.default.path.source.asset.base,_configurator2.default.path.ignore,_configurator2.default.module.directoryNames,_configurator2.default.package.main.fileNames,_configurator2.default.package.main.propertyNames,_configurator2.default.package.aliasPropertyNames);if(p)return this.addDependency(p),m||p.endsWith('.ejs')?c(p,o)(n):fileSystem.readFileSync(p,o);throw new Error(`Given template file "${l}" couldn't be resolved.`)};let i=f,j=d;for(;0<i;){if('string'==typeof j){if(e.isString)delete e.isString,j=ejs.compile(j,e);else{let k='utf-8';'encoding'in e&&(k=e.encoding),j=ejs.compile(fileSystem.readFileSync(j,{encoding:k}),e)}e.isString=!0}else j=j(_clientnode2.default.extendObject(!0,{configuration:_configurator2.default,Helper:_helper2.default,include:h,require:h,Tools:_clientnode2.default},g));i-=1}return!(f%2)?j:`module.exports = ${j.toString()};`};return c(a,{client:!!(b.compileSteps%2),compileDebug:this.debug||!1,debug:this.debug||!1,filename:loaderUtils.getRemainingRequest(this).replace(/^!/,''),isString:!0},b.compileSteps)(b.locals||{})};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ci5jb21waWxlZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuLy8gQGZsb3dcbi8vIC0qLSBjb2Rpbmc6IHV0Zi04IC0qLVxuJ3VzZSBzdHJpY3QnXG4vKiAhXG4gICAgcmVnaW9uIGhlYWRlclxuICAgIENvcHlyaWdodCBUb3JiZW4gU2lja2VydCAoaW5mb1tcIn5hdH5cIl10b3JiZW4ud2Vic2l0ZSkgMTYuMTIuMjAxMlxuXG4gICAgTGljZW5zZVxuICAgIC0tLS0tLS1cblxuICAgIFRoaXMgbGlicmFyeSB3cml0dGVuIGJ5IFRvcmJlbiBTaWNrZXJ0IHN0YW5kIHVuZGVyIGEgY3JlYXRpdmUgY29tbW9ucyBuYW1pbmdcbiAgICAzLjAgdW5wb3J0ZWQgbGljZW5zZS4gc2VlIGh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzMuMC9kZWVkLmRlXG4gICAgZW5kcmVnaW9uXG4qL1xuLy8gcmVnaW9uIGltcG9ydHNcbmltcG9ydCBUb29scyBmcm9tICdjbGllbnRub2RlJ1xuaW1wb3J0ICogYXMgZmlsZVN5c3RlbSBmcm9tICdmcydcbmltcG9ydCAqIGFzIGxvYWRlclV0aWxzIGZyb20gJ2xvYWRlci11dGlscydcbmltcG9ydCAqIGFzIGVqcyBmcm9tICdlanMnXG4vLyBOT1RFOiBPbmx5IG5lZWRlZCBmb3IgZGVidWdnaW5nIHRoaXMgZmlsZS5cbnRyeSB7XG4gICAgcmVxdWlyZSgnc291cmNlLW1hcC1zdXBwb3J0L3JlZ2lzdGVyJylcbn0gY2F0Y2ggKGVycm9yKSB7fVxuXG5pbXBvcnQgY29uZmlndXJhdGlvbiBmcm9tICcuL2NvbmZpZ3VyYXRvci5jb21waWxlZCdcbmltcG9ydCBIZWxwZXIgZnJvbSAnLi9oZWxwZXIuY29tcGlsZWQnXG4vLyBlbmRyZWdpb25cbi8vIHJlZ2lvbiB0eXBlc1xudHlwZSBUZW1wbGF0ZUZ1bmN0aW9uID0gKGxvY2FsczpPYmplY3QpID0+IHN0cmluZ1xudHlwZSBDb21waWxlRnVuY3Rpb24gPSAodGVtcGxhdGU6c3RyaW5nLCBvcHRpb25zOk9iamVjdCkgPT4gVGVtcGxhdGVGdW5jdGlvblxuLy8gZW5kcmVnaW9uXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHNvdXJjZTpzdHJpbmcpOnN0cmluZyB7XG4gICAgaWYgKHRoaXMuY2FjaGVhYmxlKVxuICAgICAgICB0aGlzLmNhY2hlYWJsZSgpXG4gICAgY29uc3QgcXVlcnk6T2JqZWN0ID0gVG9vbHMuY29udmVydFN1YnN0cmluZ0luUGxhaW5PYmplY3QoXG4gICAgICAgIFRvb2xzLmV4dGVuZE9iamVjdCh0cnVlLCB7XG4gICAgICAgICAgICBjb250ZXh0OiAnLi8nLFxuICAgICAgICAgICAgZXh0ZW5zaW9uczoge1xuICAgICAgICAgICAgICAgIGZpbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWw6IFsnLmpzJ10sXG4gICAgICAgICAgICAgICAgICAgIGludGVybmFsOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAnLmpzJywgJy5jc3MnLCAnLnN2ZycsICcucG5nJywgJy5qcGcnLCAnLmdpZicsICcuaWNvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICcuaHRtbCcsICcuanNvbicsICcuZW90JywgJy50dGYnLCAnLndvZmYnXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9LCBtb2R1bGU6IFtdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbW9kdWxlOiB7XG4gICAgICAgICAgICAgICAgYWxpYXNlczoge30sXG4gICAgICAgICAgICAgICAgcmVwbGFjZW1lbnRzOiB7fVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBpbGVTdGVwczogMlxuICAgICAgICB9LCB0aGlzLm9wdGlvbnMgfHwge30sIGxvYWRlclV0aWxzLmdldE9wdGlvbnModGhpcykgfHwge30pLFxuICAgICAgICAvIyUlJSMvZywgJyEnKVxuICAgIGNvbnN0IGNvbXBpbGU6Q29tcGlsZUZ1bmN0aW9uID0gKFxuICAgICAgICB0ZW1wbGF0ZTpzdHJpbmcsIG9wdGlvbnM6T2JqZWN0ID0gcXVlcnkuY29tcGlsZXIsXG4gICAgICAgIGNvbXBpbGVTdGVwczpudW1iZXIgPSAyXG4gICAgKTpUZW1wbGF0ZUZ1bmN0aW9uID0+IChsb2NhbHM6T2JqZWN0ID0ge30pOnN0cmluZyA9PiB7XG4gICAgICAgIG9wdGlvbnMgPSBUb29scy5leHRlbmRPYmplY3QodHJ1ZSwge2ZpbGVuYW1lOiB0ZW1wbGF0ZX0sIG9wdGlvbnMpXG4gICAgICAgIGNvbnN0IHJlcXVpcmU6RnVuY3Rpb24gPSAocmVxdWVzdDpzdHJpbmcpOnN0cmluZyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZTpzdHJpbmcgPSByZXF1ZXN0LnJlcGxhY2UoL14oLispXFw/W14/XSskLywgJyQxJylcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5TWF0Y2g6P0FycmF5PHN0cmluZz4gPSByZXF1ZXN0Lm1hdGNoKFxuICAgICAgICAgICAgICAgIC9eW14/XStcXD8oLispJC8sICckMScpXG4gICAgICAgICAgICBsZXQgbmVzdGVkTG9jYWxzOk9iamVjdCA9IHt9XG4gICAgICAgICAgICBpZiAocXVlcnlNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV2YWx1YXRpb25GdW5jdGlvbiA9IChcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdDpzdHJpbmcsIHRlbXBsYXRlOnN0cmluZywgc291cmNlOnN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgY29tcGlsZTpDb21waWxlRnVuY3Rpb24sIGxvY2FsczpPYmplY3RcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmVUeXBlQ2hlY2tcbiAgICAgICAgICAgICAgICApOk9iamVjdCA9PiBuZXcgRnVuY3Rpb24oXG4gICAgICAgICAgICAgICAgICAgICdyZXF1ZXN0JywgJ3RlbXBsYXRlJywgJ3NvdXJjZScsICdjb21waWxlJywgJ2xvY2FscycsXG4gICAgICAgICAgICAgICAgICAgIGByZXR1cm4gJHtxdWVyeU1hdGNoWzFdfWBcbiAgICAgICAgICAgICAgICApKHJlcXVlc3QsIHRlbXBsYXRlLCBzb3VyY2UsIGNvbXBpbGUsIGxvY2FscylcbiAgICAgICAgICAgICAgICBuZXN0ZWRMb2NhbHMgPSBldmFsdWF0aW9uRnVuY3Rpb24oXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3QsIHRlbXBsYXRlLCBzb3VyY2UsIGNvbXBpbGUsIGxvY2FscylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBuZXN0ZWRPcHRpb25zOk9iamVjdCA9IFRvb2xzLmNvcHlMaW1pdGVkUmVjdXJzaXZlbHkob3B0aW9ucylcbiAgICAgICAgICAgIGRlbGV0ZSBuZXN0ZWRPcHRpb25zLmNsaWVudFxuICAgICAgICAgICAgbmVzdGVkT3B0aW9ucyA9IFRvb2xzLmV4dGVuZE9iamVjdChcbiAgICAgICAgICAgICAgICB0cnVlLCB7ZW5jb2Rpbmc6ICd1dGYtOCd9LCBuZXN0ZWRPcHRpb25zLFxuICAgICAgICAgICAgICAgIG5lc3RlZExvY2Fscy5vcHRpb25zIHx8IHt9KVxuICAgICAgICAgICAgaWYgKG5lc3RlZE9wdGlvbnMuaXNTdHJpbmcpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBpbGUodGVtcGxhdGUsIG5lc3RlZE9wdGlvbnMpKG5lc3RlZExvY2FscylcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlRmlsZVBhdGg6P3N0cmluZyA9XG4gICAgICAgICAgICAgICAgSGVscGVyLmRldGVybWluZU1vZHVsZUZpbGVQYXRoKFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZSwgcXVlcnkubW9kdWxlLmFsaWFzZXMsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5Lm1vZHVsZS5yZXBsYWNlbWVudHMsIHF1ZXJ5LmV4dGVuc2lvbnMsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5LmNvbnRleHQsIGNvbmZpZ3VyYXRpb24ucGF0aC5zb3VyY2UuYXNzZXQuYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYXRoLmlnbm9yZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5tb2R1bGUuZGlyZWN0b3J5TmFtZXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucGFja2FnZS5tYWluLmZpbGVOYW1lcyxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYWNrYWdlLm1haW4ucHJvcGVydHlOYW1lcyxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbi5wYWNrYWdlLmFsaWFzUHJvcGVydHlOYW1lcylcbiAgICAgICAgICAgIGlmICh0ZW1wbGF0ZUZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGREZXBlbmRlbmN5KHRlbXBsYXRlRmlsZVBhdGgpXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgTk9URTogSWYgdGhlcmUgYXJlbid0IGFueSBsb2NhbHMgb3B0aW9ucyBvciB2YXJpYWJsZXMgYW5kXG4gICAgICAgICAgICAgICAgICAgIGZpbGUgZG9lc24ndCBzZWVtIHRvIGJlIGFuIGVqcyB0ZW1wbGF0ZSB3ZSBzaW1wbHkgbG9hZFxuICAgICAgICAgICAgICAgICAgICBpbmNsdWRlZCBmaWxlIGNvbnRlbnQuXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAocXVlcnlNYXRjaCB8fCB0ZW1wbGF0ZUZpbGVQYXRoLmVuZHNXaXRoKCcuZWpzJykpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21waWxlKHRlbXBsYXRlRmlsZVBhdGgsIG5lc3RlZE9wdGlvbnMpKFxuICAgICAgICAgICAgICAgICAgICAgICAgbmVzdGVkTG9jYWxzKVxuICAgICAgICAgICAgICAgIC8vIElnbm9yZVR5cGVDaGVja1xuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlU3lzdGVtLnJlYWRGaWxlU3luYyh0ZW1wbGF0ZUZpbGVQYXRoLCBuZXN0ZWRPcHRpb25zKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgIGBHaXZlbiB0ZW1wbGF0ZSBmaWxlIFwiJHt0ZW1wbGF0ZX1cIiBjb3VsZG4ndCBiZSByZXNvbHZlZC5gKVxuICAgICAgICB9XG4gICAgICAgIGxldCByZW1haW5pbmdTdGVwczpudW1iZXIgPSBjb21waWxlU3RlcHNcbiAgICAgICAgbGV0IHJlc3VsdDpUZW1wbGF0ZUZ1bmN0aW9ufHN0cmluZyA9IHRlbXBsYXRlXG4gICAgICAgIHdoaWxlIChyZW1haW5pbmdTdGVwcyA+IDApIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmlzU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmlzU3RyaW5nXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGVqcy5jb21waWxlKHJlc3VsdCwgb3B0aW9ucylcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5jb2Rpbmc6c3RyaW5nID0gJ3V0Zi04J1xuICAgICAgICAgICAgICAgICAgICBpZiAoJ2VuY29kaW5nJyBpbiBvcHRpb25zKVxuICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RpbmcgPSBvcHRpb25zLmVuY29kaW5nXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGVqcy5jb21waWxlKGZpbGVTeXN0ZW0ucmVhZEZpbGVTeW5jKFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LCB7ZW5jb2Rpbmd9XG4gICAgICAgICAgICAgICAgICAgICksIG9wdGlvbnMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9wdGlvbnMuaXNTdHJpbmcgPSB0cnVlXG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQoVG9vbHMuZXh0ZW5kT2JqZWN0KHRydWUsIHtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbiwgSGVscGVyLCBpbmNsdWRlOiByZXF1aXJlLCByZXF1aXJlLCBUb29sc1xuICAgICAgICAgICAgICAgIH0sIGxvY2FscykpXG4gICAgICAgICAgICByZW1haW5pbmdTdGVwcyAtPSAxXG4gICAgICAgIH1cbiAgICAgICAgaWYgKEJvb2xlYW4oY29tcGlsZVN0ZXBzICUgMikpXG4gICAgICAgICAgICByZXR1cm4gYG1vZHVsZS5leHBvcnRzID0gJHtyZXN1bHQudG9TdHJpbmcoKX07YFxuICAgICAgICAvLyBJZ25vcmVUeXBlQ2hlY2tcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH1cbiAgICByZXR1cm4gY29tcGlsZShzb3VyY2UsIHtcbiAgICAgICAgY2xpZW50OiBCb29sZWFuKHF1ZXJ5LmNvbXBpbGVTdGVwcyAlIDIpLFxuICAgICAgICBjb21waWxlRGVidWc6IHRoaXMuZGVidWcgfHwgZmFsc2UsXG4gICAgICAgIGRlYnVnOiB0aGlzLmRlYnVnIHx8IGZhbHNlLFxuICAgICAgICBmaWxlbmFtZTogbG9hZGVyVXRpbHMuZ2V0UmVtYWluaW5nUmVxdWVzdCh0aGlzKS5yZXBsYWNlKC9eIS8sICcnKSxcbiAgICAgICAgaXNTdHJpbmc6IHRydWVcbiAgICB9LCBxdWVyeS5jb21waWxlU3RlcHMpKHF1ZXJ5LmxvY2FscyB8fCB7fSlcbn1cbi8vIHJlZ2lvbiB2aW0gbW9kbGluZVxuLy8gdmltOiBzZXQgdGFic3RvcD00IHNoaWZ0d2lkdGg9NCBleHBhbmR0YWI6XG4vLyB2aW06IGZvbGRtZXRob2Q9bWFya2VyIGZvbGRtYXJrZXI9cmVnaW9uLGVuZHJlZ2lvbjpcbi8vIGVuZHJlZ2lvblxuIl19