'use strict';Object.defineProperty(exports,'__esModule',{value:!0});const onCreatedListener=[];let browserAPI;if('undefined'==typeof TARGET_TECHNOLOGY||'node'===TARGET_TECHNOLOGY){const a=require('path'),b=require('jsdom'),c=b.createVirtualConsole().sendTo(console,{omitJsdomErrors:!0});c.on('jsdomError',function(e){!browserAPI.debug&&['XMLHttpRequest','resource loading'].includes(e.type)?console.warn(`Loading resource failed: ${e.toString()}.`):console.error(e.stack,e.detail)});const d=function render(e){return b.env({created:function created(f,g){if(browserAPI={debug:!1,domContentLoaded:!1,metaDOM:b,window:g,windowLoaded:!1},browserAPI.window.document.addEventListener('DOMContentLoaded',function(){browserAPI.domContentLoaded=!0}),f)throw f;else for(const h of onCreatedListener)h(browserAPI,!1)},features:{FetchExternalResources:['script','frame','iframe','link','img'],ProcessExternalResources:['script'],SkipExternalResources:!1},html:e,onload:function onload(){browserAPI.domContentLoaded=!0,browserAPI.windowLoaded=!0},resourceLoader:function resourceLoader(f,g){return'localhost'===f.url.hostname&&(f.url.host=f.url.hostname='',f.url.port=null,f.url.protocol='file:',f.url.href=f.url.href.replace(/^[a-zA-Z]+:\/\/localhost(?::[0-9]+)?/,`file://${process.cwd()}`),f.url.path=f.url.pathname=a.join(process.cwd(),f.url.path)),browserAPI.debug&&console.info(`Load resource "${f.url.href}".`),f.defaultFetch(function(h,...i){h||g(h,...i)})},url:'http://localhost',virtualConsole:c})};'undefined'==typeof NAME||'webOptimizer'===NAME?require('fs').readFile(a.join(__dirname,'index.html.ejs'),{encoding:'utf-8'},function(e,f){if(e)throw e;d(require('ejs').compile(f,{configuration:{name:'test',givenCommandLineArguments:[]}}))}):d(require('webOptimizerDefaultTemplateFilePath'))}else browserAPI={debug:!1,domContentLoaded:!1,metaDOM:null,window,windowLoaded:!1},window.document.addEventListener('DOMContentLoaded',function(){browserAPI.domContentLoaded=!0;for(const a of onCreatedListener)a(browserAPI,!1)}),window.addEventListener('load',function(){browserAPI.windowLoaded=!0});exports.default=function(a,b=!0){const c=function wrappedCallback(...d){return b&&'undefined'!=typeof global&&global!==browserAPI.window&&(global.window=browserAPI.window),a(...d)};return'undefined'==typeof TARGET_TECHNOLOGY||'node'===TARGET_TECHNOLOGY?browserAPI?c(browserAPI,!0):onCreatedListener.push(c):browserAPI.domContentLoaded?c(browserAPI,!0):onCreatedListener.push(c)};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OlsiLy8gIyEvdXNyL2Jpbi9lbnYgbm9kZVxuLy8gQGZsb3dcbi8vIC0qLSBjb2Rpbmc6IHV0Zi04IC0qLVxuJ3VzZSBzdHJpY3QnXG4vKiAhXG4gICAgcmVnaW9uIGhlYWRlclxuICAgIENvcHlyaWdodCBUb3JiZW4gU2lja2VydCAoaW5mb1tcIn5hdH5cIl10b3JiZW4ud2Vic2l0ZSkgMTYuMTIuMjAxMlxuXG4gICAgTGljZW5zZVxuICAgIC0tLS0tLS1cblxuICAgIFRoaXMgbGlicmFyeSB3cml0dGVuIGJ5IFRvcmJlbiBTaWNrZXJ0IHN0YW5kIHVuZGVyIGEgY3JlYXRpdmUgY29tbW9ucyBuYW1pbmdcbiAgICAzLjAgdW5wb3J0ZWQgbGljZW5zZS4gc2VlIGh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzMuMC9kZWVkLmRlXG4gICAgZW5kcmVnaW9uXG4qL1xuLy8gcmVnaW9uIGltcG9ydHNcbmltcG9ydCB0eXBlIHtEb21Ob2RlLCBXaW5kb3d9IGZyb20gJ2NsaWVudG5vZGUnXG5pbXBvcnQgdHlwZSB7QnJvd3NlckFQSX0gZnJvbSAnLi90eXBlJ1xuLy8gZW5kcmVnaW9uXG4vLyByZWdpb24gZGVjbGFyYXRpb25cbi8vIE5PVEU6IFByb2R1Y2VzIGEgYmFiZWwgZXJyb3IgeWV0LlxuLy8gZGVjbGFyZSB2YXIgTkFNRTpzdHJpbmdcbi8vIGRlY2xhcmUgdmFyIFRBUkdFVF9URUNITk9MT0dZOnN0cmluZ1xuZGVjbGFyZSB2YXIgd2luZG93OldpbmRvd1xuLy8gZW5kcmVnaW9uXG4vLyByZWdpb24gdmFyaWFibGVzXG5jb25zdCBvbkNyZWF0ZWRMaXN0ZW5lcjpBcnJheTxGdW5jdGlvbj4gPSBbXVxubGV0IGJyb3dzZXJBUEk6QnJvd3NlckFQSVxuLy8gZW5kcmVnaW9uXG4vLyByZWdpb24gZW5zdXJlIHByZXNlbmNlIG9mIGNvbW1vbiBicm93c2VyIGVudmlyb25tZW50XG5pZiAodHlwZW9mIFRBUkdFVF9URUNITk9MT0dZID09PSAndW5kZWZpbmVkJyB8fCBUQVJHRVRfVEVDSE5PTE9HWSA9PT0gJ25vZGUnKSB7XG4gICAgLy8gcmVnaW9uIG1vY2sgYnJvd3NlciBlbnZpcm9ubWVudFxuICAgIGNvbnN0IHBhdGg6T2JqZWN0ID0gcmVxdWlyZSgncGF0aCcpXG4gICAgY29uc3QgbWV0YURPTTpPYmplY3QgPSByZXF1aXJlKCdqc2RvbScpXG4gICAgY29uc3QgdmlydHVhbENvbnNvbGU6T2JqZWN0ID0gbWV0YURPTS5jcmVhdGVWaXJ0dWFsQ29uc29sZSgpLnNlbmRUbyhcbiAgICAgICAgY29uc29sZSwge29taXRKc2RvbUVycm9yczogdHJ1ZX0pXG4gICAgdmlydHVhbENvbnNvbGUub24oJ2pzZG9tRXJyb3InLCAoZXJyb3I6RXJyb3IpOnZvaWQgPT4ge1xuICAgICAgICBpZiAoIWJyb3dzZXJBUEkuZGVidWcgJiYgW1xuICAgICAgICAgICAgJ1hNTEh0dHBSZXF1ZXN0JywgJ3Jlc291cmNlIGxvYWRpbmcnXG4gICAgICAgIC8vIElnbm9yZVR5cGVDaGVja1xuICAgICAgICBdLmluY2x1ZGVzKGVycm9yLnR5cGUpKVxuICAgICAgICAgICAgY29uc29sZS53YXJuKGBMb2FkaW5nIHJlc291cmNlIGZhaWxlZDogJHtlcnJvci50b1N0cmluZygpfS5gKVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICAvLyBJZ25vcmVUeXBlQ2hlY2tcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3Iuc3RhY2ssIGVycm9yLmRldGFpbClcbiAgICB9KVxuICAgIGNvbnN0IHJlbmRlcjpGdW5jdGlvbiA9ICh0ZW1wbGF0ZTpzdHJpbmcpOnZvaWQgPT4gbWV0YURPTS5lbnYoe1xuICAgICAgICBjcmVhdGVkOiAoZXJyb3I6P0Vycm9yLCB3aW5kb3c6V2luZG93KTp2b2lkID0+IHtcbiAgICAgICAgICAgIGJyb3dzZXJBUEkgPSB7XG4gICAgICAgICAgICAgICAgZGVidWc6IGZhbHNlLCBkb21Db250ZW50TG9hZGVkOiBmYWxzZSwgbWV0YURPTSwgd2luZG93LFxuICAgICAgICAgICAgICAgIHdpbmRvd0xvYWRlZDogZmFsc2V9XG4gICAgICAgICAgICBicm93c2VyQVBJLndpbmRvdy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKFxuICAgICAgICAgICAgKTp2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBicm93c2VyQVBJLmRvbUNvbnRlbnRMb2FkZWQgPSB0cnVlXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgICAgIHRocm93IGVycm9yXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjYWxsYmFjazpGdW5jdGlvbiBvZiBvbkNyZWF0ZWRMaXN0ZW5lcilcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soYnJvd3NlckFQSSwgZmFsc2UpXG4gICAgICAgIH0sXG4gICAgICAgIGZlYXR1cmVzOiB7XG4gICAgICAgICAgICBGZXRjaEV4dGVybmFsUmVzb3VyY2VzOiBbXG4gICAgICAgICAgICAgICAgJ3NjcmlwdCcsICdmcmFtZScsICdpZnJhbWUnLCAnbGluaycsICdpbWcnXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgUHJvY2Vzc0V4dGVybmFsUmVzb3VyY2VzOiBbJ3NjcmlwdCddLFxuICAgICAgICAgICAgU2tpcEV4dGVybmFsUmVzb3VyY2VzOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBodG1sOiB0ZW1wbGF0ZSxcbiAgICAgICAgb25sb2FkOiAoKTp2b2lkID0+IHtcbiAgICAgICAgICAgIGJyb3dzZXJBUEkuZG9tQ29udGVudExvYWRlZCA9IHRydWVcbiAgICAgICAgICAgIGJyb3dzZXJBUEkud2luZG93TG9hZGVkID0gdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICByZXNvdXJjZUxvYWRlcjogKFxuICAgICAgICAgICAgcmVzb3VyY2U6e1xuICAgICAgICAgICAgICAgIGVsZW1lbnQ6RG9tTm9kZTtcbiAgICAgICAgICAgICAgICB1cmw6e1xuICAgICAgICAgICAgICAgICAgICBob3N0bmFtZTpzdHJpbmc7XG4gICAgICAgICAgICAgICAgICAgIGhvc3Q6c3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICBwb3J0Oj9zdHJpbmc7XG4gICAgICAgICAgICAgICAgICAgIHByb3RvY29sOnN0cmluZztcbiAgICAgICAgICAgICAgICAgICAgaHJlZjpzdHJpbmc7XG4gICAgICAgICAgICAgICAgICAgIHBhdGg6c3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICBwYXRobmFtZTpzdHJpbmc7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb29raWU6c3RyaW5nO1xuICAgICAgICAgICAgICAgIGJhc2VVcmw6c3RyaW5nO1xuICAgICAgICAgICAgICAgIGRlZmF1bHRGZXRjaDooY2FsbGJhY2s6KFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjo/RXJyb3IsIGJvZHk6c3RyaW5nXG4gICAgICAgICAgICAgICAgKSA9PiB2b2lkKSA9PiB2b2lkXG4gICAgICAgICAgICB9LCBjYWxsYmFjazooZXJyb3I6P0Vycm9yLCBjb250ZW50OmFueSkgPT4gdm9pZFxuICAgICAgICApOnZvaWQgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc291cmNlLnVybC5ob3N0bmFtZSA9PT0gJ2xvY2FsaG9zdCcpIHtcbiAgICAgICAgICAgICAgICByZXNvdXJjZS51cmwuaG9zdCA9IHJlc291cmNlLnVybC5ob3N0bmFtZSA9ICcnXG4gICAgICAgICAgICAgICAgcmVzb3VyY2UudXJsLnBvcnQgPSBudWxsXG4gICAgICAgICAgICAgICAgcmVzb3VyY2UudXJsLnByb3RvY29sID0gJ2ZpbGU6J1xuICAgICAgICAgICAgICAgIHJlc291cmNlLnVybC5ocmVmID0gcmVzb3VyY2UudXJsLmhyZWYucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgL15bYS16QS1aXSs6XFwvXFwvbG9jYWxob3N0KD86OlswLTldKyk/LyxcbiAgICAgICAgICAgICAgICAgICAgYGZpbGU6Ly8ke3Byb2Nlc3MuY3dkKCl9YClcbiAgICAgICAgICAgICAgICByZXNvdXJjZS51cmwucGF0aCA9IHJlc291cmNlLnVybC5wYXRobmFtZSA9IHBhdGguam9pbihcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzcy5jd2QoKSwgcmVzb3VyY2UudXJsLnBhdGgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYnJvd3NlckFQSS5kZWJ1ZylcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oYExvYWQgcmVzb3VyY2UgXCIke3Jlc291cmNlLnVybC5ocmVmfVwiLmApXG4gICAgICAgICAgICByZXR1cm4gcmVzb3VyY2UuZGVmYXVsdEZldGNoKChcbiAgICAgICAgICAgICAgICBlcnJvcjo/RXJyb3IsIC4uLmFkZGl0aW9uYWxQYXJhbWV0ZXI6QXJyYXk8YW55PlxuICAgICAgICAgICAgKTp2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWVycm9yKVxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgLi4uYWRkaXRpb25hbFBhcmFtZXRlcilcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3QnLFxuICAgICAgICB2aXJ0dWFsQ29uc29sZVxuICAgIH0pXG4gICAgaWYgKHR5cGVvZiBOQU1FID09PSAndW5kZWZpbmVkJyB8fCBOQU1FID09PSAnd2ViT3B0aW1pemVyJylcbiAgICAgICAgcmVxdWlyZSgnZnMnKS5yZWFkRmlsZShwYXRoLmpvaW4oXG4gICAgICAgICAgICBfX2Rpcm5hbWUsICdpbmRleC5odG1sLmVqcydcbiAgICAgICAgKSwge2VuY29kaW5nOiAndXRmLTgnfSwgKGVycm9yOj9FcnJvciwgY29udGVudDpzdHJpbmcpOnZvaWQgPT4ge1xuICAgICAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgICAgIHRocm93IGVycm9yXG4gICAgICAgICAgICByZW5kZXIocmVxdWlyZSgnZWpzJykuY29tcGlsZShjb250ZW50LCB7XG4gICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbjoge25hbWU6ICd0ZXN0JywgZ2l2ZW5Db21tYW5kTGluZUFyZ3VtZW50czogW119fSkpXG4gICAgICAgIH0pXG4gICAgZWxzZVxuICAgICAgICAvLyBJZ25vcmVUeXBlQ2hlY2tcbiAgICAgICAgcmVuZGVyKHJlcXVpcmUoJ3dlYk9wdGltaXplckRlZmF1bHRUZW1wbGF0ZUZpbGVQYXRoJykpXG4gICAgLy8gZW5kcmVnaW9uXG59IGVsc2Uge1xuICAgIGJyb3dzZXJBUEkgPSB7XG4gICAgICAgIGRlYnVnOiBmYWxzZSwgZG9tQ29udGVudExvYWRlZDogZmFsc2UsIG1ldGFET006IG51bGwsIHdpbmRvdyxcbiAgICAgICAgd2luZG93TG9hZGVkOiBmYWxzZX1cbiAgICB3aW5kb3cuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpOnZvaWQgPT4ge1xuICAgICAgICBicm93c2VyQVBJLmRvbUNvbnRlbnRMb2FkZWQgPSB0cnVlXG4gICAgICAgIGZvciAoY29uc3QgY2FsbGJhY2s6RnVuY3Rpb24gb2Ygb25DcmVhdGVkTGlzdGVuZXIpXG4gICAgICAgICAgICBjYWxsYmFjayhicm93c2VyQVBJLCBmYWxzZSlcbiAgICB9KVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCk6dm9pZCA9PiB7XG4gICAgICAgIGJyb3dzZXJBUEkud2luZG93TG9hZGVkID0gdHJ1ZVxuICAgIH0pXG59XG4vLyBlbmRyZWdpb25cbmV4cG9ydCBkZWZhdWx0IChjYWxsYmFjazpGdW5jdGlvbiwgY2xlYXI6Ym9vbGVhbiA9IHRydWUpOmFueSA9PiB7XG4gICAgLy8gcmVnaW9uIGluaXRpYWxpemUgZ2xvYmFsIGNvbnRleHRcbiAgICAvKlxuICAgICAgICBOT1RFOiBXZSBoYXZlIHRvIGRlZmluZSB3aW5kb3cgZ2xvYmFsbHkgYmVmb3JlIGFueXRoaW5nIGlzIGxvYWRlZCB0b1xuICAgICAgICBlbnN1cmUgdGhhdCBhbGwgZnV0dXJlIGluc3RhbmNlcyBzaGFyZSB0aGUgc2FtZSB3aW5kb3cgb2JqZWN0LlxuICAgICovXG4gICAgY29uc3Qgd3JhcHBlZENhbGxiYWNrOkZ1bmN0aW9uID0gKC4uLnBhcmFtZXRlcjpBcnJheTxhbnk+KTphbnkgPT4ge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBjbGVhciAmJiB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAgICAgZ2xvYmFsICE9PSBicm93c2VyQVBJLndpbmRvd1xuICAgICAgICApXG4gICAgICAgICAgICBnbG9iYWwud2luZG93ID0gYnJvd3NlckFQSS53aW5kb3dcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKC4uLnBhcmFtZXRlcilcbiAgICB9XG4gICAgLy8gZW5kcmVnaW9uXG4gICAgaWYgKFxuICAgICAgICB0eXBlb2YgVEFSR0VUX1RFQ0hOT0xPR1kgPT09ICd1bmRlZmluZWQnIHx8XG4gICAgICAgIFRBUkdFVF9URUNITk9MT0dZID09PSAnbm9kZSdcbiAgICApXG4gICAgICAgIHJldHVybiAoYnJvd3NlckFQSSkgPyB3cmFwcGVkQ2FsbGJhY2soXG4gICAgICAgICAgICBicm93c2VyQVBJLCB0cnVlXG4gICAgICAgICkgOiBvbkNyZWF0ZWRMaXN0ZW5lci5wdXNoKHdyYXBwZWRDYWxsYmFjaylcbiAgICByZXR1cm4gKGJyb3dzZXJBUEkuZG9tQ29udGVudExvYWRlZCkgPyB3cmFwcGVkQ2FsbGJhY2soXG4gICAgICAgIGJyb3dzZXJBUEksIHRydWVcbiAgICApIDogb25DcmVhdGVkTGlzdGVuZXIucHVzaCh3cmFwcGVkQ2FsbGJhY2spXG59XG4vLyByZWdpb24gdmltIG1vZGxpbmVcbi8vIHZpbTogc2V0IHRhYnN0b3A9NCBzaGlmdHdpZHRoPTQgZXhwYW5kdGFiOlxuLy8gdmltOiBmb2xkbWV0aG9kPW1hcmtlciBmb2xkbWFya2VyPXJlZ2lvbixlbmRyZWdpb246XG4vLyBlbmRyZWdpb25cbiJdfQ==